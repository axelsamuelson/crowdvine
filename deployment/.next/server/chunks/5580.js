"use strict";exports.id=5580,exports.ids=[5580],exports.modules={8126:(e,a,t)=>{t.d(a,{Lt:()=>P,Rx:()=>L,Zr:()=>U,EO:()=>M,$v:()=>z,ck:()=>F,wd:()=>B,r7:()=>V,tv:()=>S});var r=t(60687),n=t(43210),i=t(11273),c=t(98599),o=t(25448),s=t(70569);n.forwardRef((e,a)=>{let{children:t,...i}=e,c=n.Children.toArray(t),o=c.find(_);if(o){let e=o.props.children,t=c.map(a=>a!==o?a:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,r.jsx)(l,{...i,ref:a,children:n.isValidElement(e)?n.cloneElement(e,void 0,t):null})}return(0,r.jsx)(l,{...i,ref:a,children:t})}).displayName="Slot";var l=n.forwardRef((e,a)=>{let{children:t,...r}=e;if(n.isValidElement(t)){let e=function(e){let a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=a&&"isReactWarning"in a&&a.isReactWarning;return t?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref}(t);return n.cloneElement(t,{...function(e,a){let t={...a};for(let r in a){let n=e[r],i=a[r];/^on[A-Z]/.test(r)?n&&i?t[r]=(...e)=>{i(...e),n(...e)}:n&&(t[r]=n):"style"===r?t[r]={...n,...i}:"className"===r&&(t[r]=[n,i].filter(Boolean).join(" "))}return{...e,...t}}(r,t.props),ref:a?(0,c.t)(a,e):e})}return n.Children.count(t)>1?n.Children.only(null):null});l.displayName="SlotClone";var d=({children:e})=>(0,r.jsx)(r.Fragment,{children:e});function _(e){return n.isValidElement(e)&&e.type===d}var p="AlertDialog",[u,m]=(0,i.A)(p,[o.Hs]),g=(0,o.Hs)(),f=e=>{let{__scopeAlertDialog:a,...t}=e,n=g(a);return(0,r.jsx)(o.bL,{...n,...t,modal:!0})};f.displayName=p;var h=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,...n}=e,i=g(t);return(0,r.jsx)(o.l9,{...i,...n,ref:a})});h.displayName="AlertDialogTrigger";var x=e=>{let{__scopeAlertDialog:a,...t}=e,n=g(a);return(0,r.jsx)(o.ZL,{...n,...t})};x.displayName="AlertDialogPortal";var v=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,...n}=e,i=g(t);return(0,r.jsx)(o.hJ,{...i,...n,ref:a})});v.displayName="AlertDialogOverlay";var w="AlertDialogContent",[y,b]=u(w),j=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,children:i,...l}=e,_=g(t),p=n.useRef(null),u=(0,c.s)(a,p),m=n.useRef(null);return(0,r.jsx)(o.G$,{contentName:w,titleName:N,docsSlug:"alert-dialog",children:(0,r.jsx)(y,{scope:t,cancelRef:m,children:(0,r.jsxs)(o.UC,{role:"alertdialog",..._,...l,ref:u,onOpenAutoFocus:(0,s.m)(l.onOpenAutoFocus,e=>{e.preventDefault(),m.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,r.jsx)(d,{children:i}),(0,r.jsx)(k,{contentRef:p})]})})})});j.displayName=w;var N="AlertDialogTitle",A=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,...n}=e,i=g(t);return(0,r.jsx)(o.hE,{...i,...n,ref:a})});A.displayName=N;var D="AlertDialogDescription",R=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,...n}=e,i=g(t);return(0,r.jsx)(o.VY,{...i,...n,ref:a})});R.displayName=D;var E=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,...n}=e,i=g(t);return(0,r.jsx)(o.bm,{...i,...n,ref:a})});E.displayName="AlertDialogAction";var C="AlertDialogCancel",W=n.forwardRef((e,a)=>{let{__scopeAlertDialog:t,...n}=e,{cancelRef:i}=b(C,t),s=g(t),l=(0,c.s)(a,i);return(0,r.jsx)(o.bm,{...s,...n,ref:l})});W.displayName=C;var k=({contentRef:e})=>{let a=`\`${w}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${w}\` by passing a \`${D}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${w}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return n.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,e]),null},O=t(96241),$=t(24934);let P=f,S=h,q=n.forwardRef(({className:e,...a},t)=>(0,r.jsx)(v,{className:(0,O.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a,ref:t}));q.displayName=v.displayName;let M=n.forwardRef(({className:e,...a},t)=>(0,r.jsxs)(x,{children:[(0,r.jsx)(q,{}),(0,r.jsx)(j,{ref:t,className:(0,O.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a})]}));M.displayName=j.displayName;let B=({className:e,...a})=>(0,r.jsx)("div",{className:(0,O.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...a});B.displayName="AlertDialogHeader";let F=({className:e,...a})=>(0,r.jsx)("div",{className:(0,O.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});F.displayName="AlertDialogFooter";let V=n.forwardRef(({className:e,...a},t)=>(0,r.jsx)(A,{ref:t,className:(0,O.cn)("text-lg font-semibold",e),...a}));V.displayName=A.displayName;let z=n.forwardRef(({className:e,...a},t)=>(0,r.jsx)(R,{ref:t,className:(0,O.cn)("text-sm text-muted-foreground",e),...a}));z.displayName=R.displayName;let L=n.forwardRef(({className:e,...a},t)=>(0,r.jsx)(E,{ref:t,className:(0,O.cn)((0,$.r)(),e),...a}));L.displayName=E.displayName;let U=n.forwardRef(({className:e,...a},t)=>(0,r.jsx)(W,{ref:t,className:(0,O.cn)((0,$.r)({variant:"outline"}),"mt-2 sm:mt-0",e),...a}));U.displayName=W.displayName},47451:(e,a,t)=>{t.d(a,{DeleteWineButton:()=>r});let r=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call DeleteWineButton() from the server but DeleteWineButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/axelsamuelson/Downloads/crowdvine_01/components/admin/delete-wine-button.tsx","DeleteWineButton")},62640:(e,a,t)=>{t.d(a,{DeleteWineButton:()=>_});var r=t(60687),n=t(43210),i=t(16189),c=t(24934),o=t(8126),s=t(6475);let l=(0,s.createServerReference)("40449b4a1fa1b1e01c1a42429d8368c02ccf0e79e1",s.callServer,void 0,s.findSourceMapURL,"deleteWine");var d=t(88233);function _({wineId:e,wineName:a}){let[t,s]=(0,n.useState)(!1),_=(0,i.useRouter)(),p=async()=>{s(!0);try{await l(e),_.refresh()}catch(e){console.error("Failed to delete wine:",e),alert("Failed to delete wine. Please try again.")}finally{s(!1)}};return(0,r.jsxs)(o.Lt,{children:[(0,r.jsx)(o.tv,{asChild:!0,children:(0,r.jsx)(c.$,{variant:"destructive",size:"sm",children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(o.EO,{children:[(0,r.jsxs)(o.wd,{children:[(0,r.jsx)(o.r7,{children:"Delete Wine"}),(0,r.jsxs)(o.$v,{children:['Are you sure you want to delete the wine "',a,'"? This action cannot be undone.']})]}),(0,r.jsxs)(o.ck,{children:[(0,r.jsx)(o.Zr,{children:"Cancel"}),(0,r.jsx)(o.Rx,{onClick:p,disabled:t,className:"bg-red-600 hover:bg-red-700",children:t?"Deleting...":"Delete"})]})]})]})}},84107:(e,a,t)=>{t.d(a,{k$:()=>l,ri:()=>_,AW:()=>s,Jl:()=>o,ZU:()=>d});var r=t(67218);t(79130);var n=t(89144),i=t(62351);function c(e,a=1,t=0){return Math.round(1.25*(e*a*1.147+t/100)*100)/100}async function o(){let e=await (0,n.w)(),{data:a,error:t}=await e.from("wines").select(`
      id,
      handle,
      wine_name,
      vintage,
      grape_varieties,
      color,
      label_image_path,
      base_price_cents,
      producer_id,
      cost_currency,
      cost_amount,
      exchange_rate_source,
      exchange_rate_date,
      exchange_rate_period_start,
      exchange_rate_period_end,
      exchange_rate,
      alcohol_tax_cents,
      price_includes_vat,
      margin_percentage,
      calculated_price_cents,
      supplier_price,
      sb_price,
      volume_liters,
      description,
      description_html,
      created_at,
      updated_at
    `).order("wine_name");if(t)throw Error(t.message);let r=[...new Set(a.map(e=>e.producer_id))],{data:i}=await e.from("producers").select("id, name").in("id",r),c=new Map(i?.map(e=>[e.id,e])||[]);return a.map(e=>({...e,producer:c.get(e.producer_id)}))}async function s(e){let a=await (0,n.w)(),{data:t,error:r}=await a.from("wines").select(`
      id,
      handle,
      wine_name,
      vintage,
      grape_varieties,
      color,
      label_image_path,
      base_price_cents,
      producer_id,
      cost_currency,
      cost_amount,
      exchange_rate_source,
      exchange_rate_date,
      exchange_rate_period_start,
      exchange_rate_period_end,
      exchange_rate,
      alcohol_tax_cents,
      price_includes_vat,
      margin_percentage,
      calculated_price_cents,
      supplier_price,
      sb_price,
      volume_liters,
      description,
      description_html,
      created_at,
      updated_at
    `).eq("id",e).single();if(r)throw Error(r.message);let{data:i}=await a.from("producers").select("name").eq("id",t.producer_id).single();return{...t,producer:i}}async function l(e){let a=await (0,n.w)(),t=e.base_price_cents,r=null;if(e.cost_amount&&e.cost_amount>0){let a=e.exchange_rate||1,n=e.cost_amount*a*(1+(e.margin_percentage||30)/100)+(e.alcohol_tax_cents||0)/100;t=Math.ceil(100*(!1!==e.price_includes_vat?n:1.25*n)),e.cost_amount&&e.cost_amount>0&&(r=c(e.cost_amount,e.exchange_rate||1,e.alcohol_tax_cents||0))}let o={...e,base_price_cents:t,calculated_price_cents:t,sb_price:r},{data:s,error:l}=await a.from("wines").insert(o).select(`
      id,
      handle,
      wine_name,
      vintage,
      grape_varieties,
      color,
      label_image_path,
      base_price_cents,
      producer_id,
      cost_currency,
      cost_amount,
      exchange_rate_source,
      exchange_rate_date,
      exchange_rate_period_start,
      exchange_rate_period_end,
      exchange_rate,
      alcohol_tax_cents,
      price_includes_vat,
      margin_percentage,
      calculated_price_cents,
      supplier_price,
      sb_price,
      volume_liters,
      created_at,
      updated_at
    `).single();if(l)throw Error(l.message);let{data:d}=await a.from("producers").select("name").eq("id",s.producer_id).single(),_={...s,producer:d};return(0,i.revalidatePath)("/admin/wines"),_}async function d(e,a){let t=await (0,n.w)(),r={};if(void 0!==a.handle&&(r.handle=a.handle),void 0!==a.wine_name&&(r.wine_name=a.wine_name),void 0!==a.vintage&&(r.vintage=a.vintage),void 0!==a.grape_varieties&&(r.grape_varieties=a.grape_varieties),void 0!==a.color&&(r.color=a.color),void 0!==a.label_image_path&&(r.label_image_path=a.label_image_path),void 0!==a.base_price_cents&&(r.base_price_cents=a.base_price_cents),void 0!==a.producer_id&&(r.producer_id=a.producer_id),void 0!==a.cost_currency&&(r.cost_currency=a.cost_currency),void 0!==a.cost_amount&&(r.cost_amount=a.cost_amount),void 0!==a.exchange_rate_source&&(r.exchange_rate_source=a.exchange_rate_source),void 0!==a.exchange_rate_date&&(r.exchange_rate_date=a.exchange_rate_date),void 0!==a.exchange_rate_period_start&&(r.exchange_rate_period_start=a.exchange_rate_period_start),void 0!==a.exchange_rate_period_end&&(r.exchange_rate_period_end=a.exchange_rate_period_end),void 0!==a.exchange_rate&&(r.exchange_rate=a.exchange_rate),void 0!==a.alcohol_tax_cents&&(r.alcohol_tax_cents=a.alcohol_tax_cents),void 0!==a.price_includes_vat&&(r.price_includes_vat=a.price_includes_vat),void 0!==a.margin_percentage&&(r.margin_percentage=a.margin_percentage),void 0!==a.description&&(r.description=a.description),void 0!==a.description_html&&(r.description_html=a.description_html),void 0!==a.supplier_price&&(r.supplier_price=a.supplier_price),void 0!==a.volume_liters&&(r.volume_liters=a.volume_liters),void 0!==r.cost_amount||void 0!==r.exchange_rate||void 0!==r.alcohol_tax_cents||void 0!==r.price_includes_vat||void 0!==r.margin_percentage){let{data:a}=await t.from("wines").select("cost_amount, exchange_rate, alcohol_tax_cents, price_includes_vat, margin_percentage, volume_liters").eq("id",e).single(),n=r.cost_amount??a?.cost_amount??0,i=r.exchange_rate??a?.exchange_rate??1,c=r.alcohol_tax_cents??a?.alcohol_tax_cents??0,o=r.price_includes_vat??a?.price_includes_vat??!0,s=n*i*(1+(r.margin_percentage??a?.margin_percentage??30)/100)+c/100,l=Math.ceil(100*(o?s:1.25*s));r.calculated_price_cents=l,r.base_price_cents=l}if(void 0!==r.cost_amount&&r.cost_amount>0){let e=r.exchange_rate??currentWine?.exchange_rate??1,a=r.alcohol_tax_cents??currentWine?.alcohol_tax_cents??0;r.sb_price=c(r.cost_amount,e,a)}let{data:o,error:s}=await t.from("wines").update(r).eq("id",e).select(`
      id,
      handle,
      wine_name,
      vintage,
      grape_varieties,
      color,
      label_image_path,
      base_price_cents,
      producer_id,
      cost_currency,
      cost_amount,
      exchange_rate_source,
      exchange_rate_date,
      exchange_rate_period_start,
      exchange_rate_period_end,
      exchange_rate,
      alcohol_tax_cents,
      price_includes_vat,
      margin_percentage,
      calculated_price_cents,
      supplier_price,
      sb_price,
      volume_liters,
      created_at,
      updated_at
    `).single();if(s)throw console.error("Update wine error:",s),Error(s.message);let{data:l}=await t.from("producers").select("name").eq("id",o.producer_id).single(),d={...o,producer:l};return(0,i.revalidatePath)("/admin/wines"),(0,i.revalidatePath)(`/admin/wines/${e}`),d}async function _(e){let a=await (0,n.w)(),{error:t}=await a.from("wines").delete().eq("id",e);if(t)throw Error(t.message);(0,i.revalidatePath)("/admin/wines")}(0,t(17478).D)([o,s,l,d,_]),(0,r.A)(o,"00f5f7f80f14491a3796af19d4a438f72ece93c2e1",null),(0,r.A)(s,"4007494c21df392b4022c081277df8425dc3491bf1",null),(0,r.A)(l,"40400762e92e9a18c27f749da35b9792097f301365",null),(0,r.A)(d,"600d783cb3bc5d9bf756e6d6da6ee83de2ee57c3f9",null),(0,r.A)(_,"40449b4a1fa1b1e01c1a42429d8368c02ccf0e79e1",null)},88233:(e,a,t)=>{t.d(a,{A:()=>r});let r=(0,t(62688).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}};