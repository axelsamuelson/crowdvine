"use strict";exports.id=2802,exports.ids=[2802],exports.modules={3018:(e,r,t)=>{t.d(r,{Fc:()=>l,TN:()=>c,XL:()=>i,ju:()=>d});var a=t(60687),s=t(43210),o=t(24224),n=t(96241);let d=(0,o.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-3 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-card text-foreground",destructive:"border-destructive/50 bg-card text-destructive dark:border-destructive [&>svg]:text-destructive",success:"border-green-500/50 bg-green-50 text-green-700 dark:border-green-500 dark:bg-green-950 dark:text-green-300 [&>svg]:text-green-600 dark:[&>svg]:text-green-400"}},defaultVariants:{variant:"default"}}),l=s.forwardRef(({className:e,variant:r,...t},s)=>(0,a.jsx)("div",{ref:s,role:"alert",className:(0,n.cn)(d({variant:r}),e),...t}));l.displayName="Alert";let i=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...r}));i.displayName="AlertTitle";let c=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...r}));c.displayName="AlertDescription"},36852:(e,r,t)=>{t.d(r,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/axelsamuelson/Downloads/crowdvine_01/components/admin/zone-form.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/axelsamuelson/Downloads/crowdvine_01/components/admin/zone-form.tsx","default")},39390:(e,r,t)=>{t.d(r,{J:()=>i});var a=t(60687),s=t(43210),o=t(78696),n=t(24224),d=t(96241);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(o.b,{ref:t,className:(0,d.cn)(l(),e),...r}));i.displayName=o.b.displayName},55192:(e,r,t)=>{t.d(r,{BT:()=>i,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>d});var a=t(60687),s=t(43210),o=t(96241);let n=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-md bg-card text-card-foreground",e),...r}));n.displayName="Card";let d=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-4",e),...r}));d.displayName="CardHeader";let l=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,o.cn)("font-semibold text-lg leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let i=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",e),...r}));i.displayName="CardDescription";let c=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-4 pt-0",e),...r}));c.displayName="CardContent",s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},68988:(e,r,t)=>{t.d(r,{j:()=>n,p:()=>d});var a=t(60687),s=t(43210),o=t(96241);let n=(0,t(24224).F)("flex w-full rounded-full transition-[background-color,box-shadow] backdrop-blur-sm duration-200 ease-out bg-primary/20 shadow-sm ring-1 ring-transparent focus-visible:bg-primary/20 focus-visible:ring-1 focus-visible:ring-primary/40 focus-visible:ring-offset-4 focus-visible:ring-offset-black/10 disabled:cursor-not-allowed disabled:opacity-50 md:text-base text-white border-2 border-white/50 h-11 !text-base placeholder:text-white/80 focus:outline-none px-4"),d=s.forwardRef(({className:e,type:r,...t},s)=>(0,a.jsx)("input",{type:r,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-white px-3 py-1 text-base transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","aria-[invalid=true]:border-red-500 aria-[invalid=true]:focus-visible:!ring-red-500",e),ref:s,...t}));d.displayName="Input"},78696:(e,r,t)=>{t.d(r,{b:()=>l});var a=t(43210);t(51215);var s=t(11329),o=t(60687),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let t=(0,s.TL)(`Primitive.${r}`),n=a.forwardRef((e,a)=>{let{asChild:s,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(s?t:r,{...n,ref:a})});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{}),d=a.forwardRef((e,r)=>(0,o.jsx)(n.label,{...e,ref:r,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));d.displayName="Label";var l=d},93751:(e,r,t)=>{t.d(r,{default:()=>v});var a=t(60687),s=t(43210),o=t(16189),n=t(24934),d=t(68988),l=t(39390),i=t(55192),c=t(3018),u=t(6475);let p=(0,u.createServerReference)("6031f27b758a14bb4f1c3504410a6f98776f2a9fb8",u.callServer,void 0,u.findSourceMapURL,"updatePalletZone"),m=(0,u.createServerReference)("40a444c12121f7044740951b7079ed317801357a48",u.callServer,void 0,u.findSourceMapURL,"createPalletZone"),f=new Map;async function g(e){let r=e.trim().replace(/\s+/g," ");if(f.has(r))return console.log("\uD83D\uDCCD Using cached geocode result for:",r),f.get(r);try{console.log("\uD83C\uDF0D Geocoding address:",r);let e=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(r)}&limit=1&addressdetails=1&countrycodes=se,no,dk,fi,fr,de,gb,es,it&accept-language=en`);if(!e.ok)throw Error(`Geocoding API error: ${e.status}`);let t=await e.json();if(!t||0===t.length)return{error:"NO_RESULTS",message:"No coordinates found for this address"};let a=t[0],s={lat:parseFloat(a.lat),lon:parseFloat(a.lon),display_name:a.display_name,address:a.address?{house_number:a.address.house_number,road:a.address.road,city:a.address.city||a.address.town||a.address.village,postcode:a.address.postcode,country:a.address.country,country_code:a.address.country_code?.toUpperCase()}:void 0};return f.set(r,s),console.log("✅ Geocoded successfully:",{address:r,lat:s.lat,lon:s.lon,city:s.address?.city}),s}catch(e){return console.error("❌ Geocoding error:",e),{error:"GEOCODING_FAILED",message:`Failed to geocode address: ${e instanceof Error?e.message:"Unknown error"}`}}}async function x(e){if(!e.city||!e.country)return{error:"MISSING_REQUIRED_FIELDS",message:"City and country are required for geocoding"};let r=[];e.street&&r.push(e.street),e.postcode&&r.push(e.postcode),r.push(e.city),r.push(e.country);let t=r.join(", ");return await g(t)}function v({zone:e}){let[r,t]=(0,s.useState)({name:e?.name||"",radius_km:e?.radius_km||500,center_lat:e?.center_lat||0,center_lon:e?.center_lon||0,zone_type:e?.zone_type||"delivery"}),[u,f]=(0,s.useState)(""),[v,h]=(0,s.useState)({street:"",postcode:"",city:"",country:""}),[y,b]=(0,s.useState)(""),[j,w]=(0,s.useState)(!1),[N,C]=(0,s.useState)(!1),_=(0,o.useRouter)(),k=async t=>{t.preventDefault(),w(!0),b("");try{e?await p(e.id,r):await m(r),_.push("/admin/zones")}catch(e){b(e instanceof Error?e.message:"An error occurred")}finally{w(!1)}},R=(e,r)=>{t(t=>({...t,[e]:r}))},S=async()=>{if(!u.trim()){b("Please enter an address to geocode");return}C(!0),b("");try{let e=await g(u.trim());"error"in e?b(`Geocoding failed: ${e.message}`):(t(r=>({...r,center_lat:e.lat,center_lon:e.lon})),b(""),console.log("✅ Coordinates updated:",e.lat,e.lon))}catch(e){b(`Geocoding error: ${e instanceof Error?e.message:"Unknown error"}`)}finally{C(!1)}},F=async()=>{if(!v.city.trim()||!v.country.trim()){b("City and country are required for geocoding");return}C(!0),b("");try{let e=await x(v);"error"in e?b(`Geocoding failed: ${e.message}`):(t(r=>({...r,center_lat:e.lat,center_lon:e.lon})),b(""),console.log("✅ Coordinates updated:",e.lat,e.lon))}catch(e){b(`Geocoding error: ${e instanceof Error?e.message:"Unknown error"}`)}finally{C(!1)}};return(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsx)(i.ZB,{children:e?"Edit Zone":"Add Zone"}),(0,a.jsx)(i.BT,{children:e?"Update zone configuration":"Create a new delivery zone"})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[y&&(0,a.jsx)(c.Fc,{variant:"destructive",children:(0,a.jsx)(c.TN,{children:y})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"name",children:"Zone Name *"}),(0,a.jsx)(d.p,{id:"name",value:r.name,onChange:e=>R("name",e.target.value),placeholder:"B\xe9ziers 500 km",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"zone_type",children:"Zone Type *"}),(0,a.jsxs)("select",{id:"zone_type",value:r.zone_type,onChange:e=>R("zone_type",e.target.value),className:"flex h-10 w-full rounded-md border border-input bg-white px-3 py-1 text-base transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm aria-[invalid=true]:border-red-500 aria-[invalid=true]:focus-visible:!ring-red-500",required:!0,children:[(0,a.jsx)("option",{value:"delivery",children:"Delivery Zone"}),(0,a.jsx)("option",{value:"pickup",children:"Pickup Zone"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"address",children:"Center Address (for automatic coordinates)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.p,{id:"address",value:u,onChange:e=>f(e.target.value),placeholder:"Stockholm, Sweden or Grevgatan 49, 11458 Stockholm",className:"flex-1"}),(0,a.jsx)(n.$,{type:"button",variant:"outline",onClick:S,disabled:N||!u.trim(),children:N?"Getting...":"Get Coordinates"})]})]}),(0,a.jsx)("div",{className:"text-center text-sm text-muted-foreground",children:"OR use separate fields below"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"street",children:"Street Address (optional)"}),(0,a.jsx)(d.p,{id:"street",value:v.street,onChange:e=>h(r=>({...r,street:e.target.value})),placeholder:"Grevgatan 49"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"postcode",children:"Postcode (optional)"}),(0,a.jsx)(d.p,{id:"postcode",value:v.postcode,onChange:e=>h(r=>({...r,postcode:e.target.value})),placeholder:"11458"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"city",children:"City *"}),(0,a.jsx)(d.p,{id:"city",value:v.city,onChange:e=>h(r=>({...r,city:e.target.value})),placeholder:"Stockholm",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"country",children:"Country *"}),(0,a.jsx)(d.p,{id:"country",value:v.country,onChange:e=>h(r=>({...r,country:e.target.value})),placeholder:"Sweden",required:!0})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(n.$,{type:"button",variant:"outline",onClick:F,disabled:N||!v.city.trim()||!v.country.trim(),children:N?"Getting...":"Get Coordinates from Fields"})}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"Enter city and country (required) to automatically get coordinates, or manually enter them below."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"center_lat",children:"Center Latitude *"}),(0,a.jsx)(d.p,{id:"center_lat",type:"number",step:"0.0001",value:r.center_lat,onChange:e=>R("center_lat",parseFloat(e.target.value)||0),placeholder:"59.3293",required:!0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Auto-filled when using address above"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"center_lon",children:"Center Longitude *"}),(0,a.jsx)(d.p,{id:"center_lon",type:"number",step:"0.0001",value:r.center_lon,onChange:e=>R("center_lon",parseFloat(e.target.value)||0),placeholder:"18.0686",required:!0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Auto-filled when using address above"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"radius_km",children:"Radius (km) *"}),(0,a.jsx)(d.p,{id:"radius_km",type:"number",step:"1",value:r.radius_km,onChange:e=>R("radius_km",parseInt(e.target.value)||0),placeholder:"50",required:!0})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)(n.$,{type:"button",variant:"outline",onClick:()=>_.back(),children:"Cancel"}),(0,a.jsx)(n.$,{type:"submit",disabled:j,children:j?"Saving...":e?"Update Zone":"Create Zone"})]})]})})]})}}};