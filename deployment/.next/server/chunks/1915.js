"use strict";exports.id=1915,exports.ids=[1915],exports.modules={3018:(e,r,t)=>{t.d(r,{Fc:()=>n,TN:()=>c,XL:()=>l,ju:()=>o});var a=t(60687),s=t(43210),i=t(24224),d=t(96241);let o=(0,i.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-3 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-card text-foreground",destructive:"border-destructive/50 bg-card text-destructive dark:border-destructive [&>svg]:text-destructive",success:"border-green-500/50 bg-green-50 text-green-700 dark:border-green-500 dark:bg-green-950 dark:text-green-300 [&>svg]:text-green-600 dark:[&>svg]:text-green-400"}},defaultVariants:{variant:"default"}}),n=s.forwardRef(({className:e,variant:r,...t},s)=>(0,a.jsx)("div",{ref:s,role:"alert",className:(0,d.cn)(o({variant:r}),e),...t}));n.displayName="Alert";let l=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("h5",{ref:t,className:(0,d.cn)("mb-1 font-medium leading-none tracking-tight",e),...r}));l.displayName="AlertTitle";let c=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,d.cn)("text-sm [&_p]:leading-relaxed",e),...r}));c.displayName="AlertDescription"},5957:(e,r,t)=>{t.d(r,{By:()=>u,a5:()=>p,yn:()=>o,Bx:()=>c,MT:()=>l,AQ:()=>n,gd:()=>f});var a=t(91199);t(42087);var s=t(14605);function i(){let e="https://abrnvjqwpdkodgrtezeg.supabase.co",r=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e||!r)throw Error("Missing Supabase admin credentials");return(0,s.UU)(e,r)}var d=t(7944);async function o(){let e=i(),{data:r,error:t}=await e.from("pallet_zones").select("*").eq("zone_type","delivery").order("name");if(t)throw Error(t.message);return r}async function n(){let e=i(),{data:r,error:t}=await e.from("pallet_zones").select("*").eq("zone_type","pickup").order("name");if(t)throw Error(t.message);return r}async function l(){let e=i(),{data:r,error:t}=await e.from("pallet_zones").select("*").order("name");if(t)throw Error(t.message);return r}async function c(e){let r=i(),{data:t,error:a}=await r.from("pallet_zones").select("*").eq("id",e).single();if(a)throw Error(a.message);return t}async function u(e){let r=i(),{data:t,error:a}=await r.from("pallet_zones").insert(e).select().single();if(a)throw Error(a.message);return(0,d.revalidatePath)("/admin/zones"),t}async function f(e,r){let t=i(),{data:a,error:s}=await t.from("pallet_zones").update(r).eq("id",e).select().single();if(s)throw Error(s.message);return(0,d.revalidatePath)("/admin/zones"),(0,d.revalidatePath)(`/admin/zones/${e}`),a}async function p(e){let r=i(),{data:t,error:a}=await r.from("producers").select("id, name").eq("pickup_zone_id",e).limit(5);if(a)throw Error(`Failed to check producer usage: ${a.message}`);if(t&&t.length>0){let e=t.map(e=>`"${e.name}" (${e.id.substring(0,8)}...)`).join(", ");throw Error(`Cannot delete zone: This zone is currently used by ${t.length} producer(s): ${e}. You must first reassign these producers to different zones before deleting this zone.`)}let{data:s,error:o}=await r.from("order_reservations").select("id, status, created_at").or(`pickup_zone_id.eq.${e},delivery_zone_id.eq.${e}`).limit(5);if(o)throw Error(`Failed to check zone usage: ${o.message}`);if(s&&s.length>0){let e=s.map(e=>`Reservation ${e.id.substring(0,8)}... (${e.status}, created ${new Date(e.created_at).toLocaleDateString()})`).join(", ");throw Error(`Cannot delete zone: This zone is currently used in ${s.length} existing reservation(s): ${e}. You must first reassign or cancel these reservations before deleting the zone.`)}let{data:n,error:l}=await r.from("pallets").select("id, name").or(`pickup_zone_id.eq.${e},delivery_zone_id.eq.${e}`).limit(5);if(l)throw Error(`Failed to check pallet usage: ${l.message}`);if(n&&n.length>0){let e=n.map(e=>`"${e.name}" (${e.id.substring(0,8)}...)`).join(", ");throw Error(`Cannot delete zone: This zone is currently used in ${n.length} existing pallet(s): ${e}. You must first remove or reassign these pallets before deleting the zone.`)}let{error:c}=await r.from("pallet_zones").delete().eq("id",e);if(c)throw Error(c.message);(0,d.revalidatePath)("/admin/zones")}(0,t(33331).D)([o,n,l,c,u,f,p]),(0,a.A)(o,"000e63333e77ec660d6d2d6ca150c337f91a6b8c32",null),(0,a.A)(n,"00251355d62698800fe85cf33b4e8cfe6639d5e0fb",null),(0,a.A)(l,"006c03375aaa39f2cd2086349cb8f87fcc5226db80",null),(0,a.A)(c,"407e35c5facea15df629efd07347f872bacfe07eab",null),(0,a.A)(u,"40a444c12121f7044740951b7079ed317801357a48",null),(0,a.A)(f,"6031f27b758a14bb4f1c3504410a6f98776f2a9fb8",null),(0,a.A)(p,"40bb6eb08a22875d7b617bd683be7bb3c9b6ccfebc",null)},15616:(e,r,t)=>{t.d(r,{T:()=>d});var a=t(60687),s=t(43210),i=t(96241);let d=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:t,...r}));d.displayName="Textarea"},39390:(e,r,t)=>{t.d(r,{J:()=>l});var a=t(60687),s=t(43210),i=t(78696),d=t(24224),o=t(96241);let n=(0,d.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(i.b,{ref:t,className:(0,o.cn)(n(),e),...r}));l.displayName=i.b.displayName},44644:(e,r,t)=>{t.d(r,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/axelsamuelson/Downloads/crowdvine_01/components/admin/producer-form.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/axelsamuelson/Downloads/crowdvine_01/components/admin/producer-form.tsx","default")},55192:(e,r,t)=>{t.d(r,{BT:()=>l,Wu:()=>c,ZB:()=>n,Zp:()=>d,aR:()=>o});var a=t(60687),s=t(43210),i=t(96241);let d=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-md bg-card text-card-foreground",e),...r}));d.displayName="Card";let o=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-4",e),...r}));o.displayName="CardHeader";let n=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold text-lg leading-none tracking-tight",e),...r}));n.displayName="CardTitle";let l=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));l.displayName="CardDescription";let c=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-4 pt-0",e),...r}));c.displayName="CardContent",s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},68988:(e,r,t)=>{t.d(r,{j:()=>d,p:()=>o});var a=t(60687),s=t(43210),i=t(96241);let d=(0,t(24224).F)("flex w-full rounded-full transition-[background-color,box-shadow] backdrop-blur-sm duration-200 ease-out bg-primary/20 shadow-sm ring-1 ring-transparent focus-visible:bg-primary/20 focus-visible:ring-1 focus-visible:ring-primary/40 focus-visible:ring-offset-4 focus-visible:ring-offset-black/10 disabled:cursor-not-allowed disabled:opacity-50 md:text-base text-white border-2 border-white/50 h-11 !text-base placeholder:text-white/80 focus:outline-none px-4"),o=s.forwardRef(({className:e,type:r,...t},s)=>(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-white px-3 py-1 text-base transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","aria-[invalid=true]:border-red-500 aria-[invalid=true]:focus-visible:!ring-red-500",e),ref:s,...t}));o.displayName="Input"},74742:(e,r,t)=>{t.d(r,{default:()=>g});var a=t(60687),s=t(43210),i=t(16189),d=t(24934),o=t(68988),n=t(39390),l=t(15616),c=t(55192),u=t(3018),f=t(6475);let p=(0,f.createServerReference)("605ef108f16894d4d036ef44663d30f2fdb4f32d28",f.callServer,void 0,f.findSourceMapURL,"updateProducer"),m=(0,f.createServerReference)("407cc8c4465a7985dbae48dd93d0b97fd1d9938259",f.callServer,void 0,f.findSourceMapURL,"createProducer");function g({producer:e}){let[r,t]=(0,s.useState)({name:e?.name||"",region:e?.region||"",lat:e?.lat||0,lon:e?.lon||0,country_code:e?.country_code||"",address_street:e?.address_street||"",address_city:e?.address_city||"",address_postcode:e?.address_postcode||"",short_description:e?.short_description||"",logo_image_path:e?.logo_image_path||"",pickup_zone_id:e?.pickup_zone_id||""}),[f,g]=(0,s.useState)(""),[h,v]=(0,s.useState)(!1),[x,b]=(0,s.useState)([]),y=(0,i.useRouter)(),_=async t=>{t.preventDefault(),v(!0),g("");try{e?await p(e.id,r):await m(r),y.push("/admin/producers")}catch(e){g(e instanceof Error?e.message:"An error occurred")}finally{v(!1)}},w=(e,r)=>{t(t=>({...t,[e]:r}))};return(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:e?"Edit Producer":"Add Producer"}),(0,a.jsx)(c.BT,{children:e?"Update producer information":"Create a new wine producer"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[f&&(0,a.jsx)(u.Fc,{variant:"destructive",children:(0,a.jsx)(u.TN,{children:f})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"name",children:"Name *"}),(0,a.jsx)(o.p,{id:"name",value:r.name,onChange:e=>w("name",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"region",children:"Region *"}),(0,a.jsx)(o.p,{id:"region",value:r.region,onChange:e=>w("region",e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"lat",children:"Latitude *"}),(0,a.jsx)(o.p,{id:"lat",type:"number",step:"0.0001",value:r.lat,onChange:e=>w("lat",parseFloat(e.target.value)||0),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"lon",children:"Longitude *"}),(0,a.jsx)(o.p,{id:"lon",type:"number",step:"0.0001",value:r.lon,onChange:e=>w("lon",parseFloat(e.target.value)||0),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"country_code",children:"Country Code *"}),(0,a.jsx)(o.p,{id:"country_code",value:r.country_code,onChange:e=>w("country_code",e.target.value),placeholder:"FR",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"address_street",children:"Street Address *"}),(0,a.jsx)(o.p,{id:"address_street",value:r.address_street,onChange:e=>w("address_street",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"address_city",children:"City *"}),(0,a.jsx)(o.p,{id:"address_city",value:r.address_city,onChange:e=>w("address_city",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"address_postcode",children:"Postal Code *"}),(0,a.jsx)(o.p,{id:"address_postcode",value:r.address_postcode,onChange:e=>w("address_postcode",e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"short_description",children:"Description"}),(0,a.jsx)(l.T,{id:"short_description",value:r.short_description,onChange:e=>w("short_description",e.target.value),rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"logo_image_path",children:"Logo Image URL"}),(0,a.jsx)(o.p,{id:"logo_image_path",type:"url",value:r.logo_image_path,onChange:e=>w("logo_image_path",e.target.value),placeholder:"https://example.com/image.jpg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"pickup_zone_id",children:"Pickup Zone"}),(0,a.jsxs)("select",{id:"pickup_zone_id",value:r.pickup_zone_id||"",onChange:e=>w("pickup_zone_id",e.target.value),className:"flex h-10 w-full rounded-md border border-input bg-white px-3 py-1 text-base transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm aria-[invalid=true]:border-red-500 aria-[invalid=true]:focus-visible:!ring-red-500",children:[(0,a.jsx)("option",{value:"",children:"No pickup zone selected"}),x.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>y.back(),children:"Cancel"}),(0,a.jsx)(d.$,{type:"submit",disabled:h,children:h?"Saving...":e?"Update Producer":"Create Producer"})]})]})})]})}f.callServer,f.findSourceMapURL},78696:(e,r,t)=>{t.d(r,{b:()=>n});var a=t(43210);t(51215);var s=t(11329),i=t(60687),d=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let t=(0,s.TL)(`Primitive.${r}`),d=a.forwardRef((e,a)=>{let{asChild:s,...d}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(s?t:r,{...d,ref:a})});return d.displayName=`Primitive.${r}`,{...e,[r]:d}},{}),o=a.forwardRef((e,r)=>(0,i.jsx)(d.label,{...e,ref:r,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));o.displayName="Label";var n=o}};