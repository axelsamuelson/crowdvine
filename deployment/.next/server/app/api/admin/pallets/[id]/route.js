(()=>{var e={};e.id=4811,e.ids=[4811],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},89144:(e,t,r)=>{"use strict";r.d(t,{H:()=>a,w:()=>i});var s=r(44999),o=r(34386);async function i(){let e=await (0,s.UL)(),t="https://abrnvjqwpdkodgrtezeg.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFicm52anF3cGRrb2RncnRlemVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NzQwNjMsImV4cCI6MjA3MjI1MDA2M30.I_i63rAdVM51CKwic2GhNY5z7WKzA8p8OdVVh8-YiGs";if(!t||!r)throw console.error("Missing Supabase environment variables:"),console.error("NEXT_PUBLIC_SUPABASE_URL:",t?"SET":"MISSING"),console.error("NEXT_PUBLIC_SUPABASE_ANON_KEY:",r?"SET":"MISSING"),Error("Supabase environment variables are not configured. Please check your .env.local file.");return(0,o.createServerClient)(t,r,{cookies:{get:t=>e.get(t)?.value,set(e,t,r){console.log(`Cookie ${e} would be set to ${t}`)},remove(e,t){console.log(`Cookie ${e} would be removed`)}}})}async function a(){let e=await i(),{data:{user:t},error:r}=await e.auth.getUser();return r?(console.error("Error getting current user:",r),null):t}},89618:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>c,serverHooks:()=>w,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{DELETE:()=>d,GET:()=>u,PUT:()=>p});var o=r(96559),i=r(48088),a=r(37719),n=r(32190),l=r(89144);async function u(e,{params:t}){let r=await (0,l.w)(),s=await t,{data:o,error:i}=await r.from("pallets").select(`
      *,
      delivery_zone:pallet_zones!delivery_zone_id(id, name, zone_type),
      pickup_zone:pallet_zones!pickup_zone_id(id, name, zone_type)
    `).eq("id",s.id).single();return i?n.NextResponse.json({error:i.message},{status:500}):o?n.NextResponse.json(o):n.NextResponse.json({error:"Pallet not found"},{status:404})}async function p(e,{params:t}){let r=await (0,l.w)(),s=await t,o=await e.json(),{data:i,error:a}=await r.from("pallets").update({...o,updated_at:new Date().toISOString()}).eq("id",s.id).select().single();return a?n.NextResponse.json({error:a.message},{status:500}):n.NextResponse.json(i)}async function d(e,{params:t}){let r=await (0,l.w)(),s=await t,{data:o,error:i}=await r.from("bookings").select("id").eq("pallet_id",s.id).limit(1);if(i)return n.NextResponse.json({error:`Failed to check bookings: ${i.message}`},{status:500});if(o&&o.length>0)return n.NextResponse.json({error:`Cannot delete pallet: It has ${o.length} associated booking(s). Please remove all bookings first.`},{status:400});let{data:a,error:u}=await r.from("pallets").select("delivery_zone_id, pickup_zone_id").eq("id",s.id).single();if(u)return n.NextResponse.json({error:`Failed to get pallet: ${u.message}`},{status:500});let{data:p,error:d}=await r.from("order_reservations").select("id").or(`pickup_zone_id.eq.${a.pickup_zone_id},delivery_zone_id.eq.${a.delivery_zone_id}`).limit(1);if(d)return n.NextResponse.json({error:`Failed to check reservations: ${d.message}`},{status:500});if(p&&p.length>0)return n.NextResponse.json({error:`Cannot delete pallet: Its zones are used in ${p.length} reservation(s). Please remove all reservations first.`},{status:400});let{error:c}=await r.from("pallets").delete().eq("id",s.id);return c?n.NextResponse.json({error:`Failed to delete pallet: ${c.message}`},{status:500}):n.NextResponse.json({success:!0})}let c=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/admin/pallets/[id]/route",pathname:"/api/admin/pallets/[id]",filename:"route",bundlePath:"app/api/admin/pallets/[id]/route"},resolvedPagePath:"/Users/axelsamuelson/Downloads/crowdvine_01/app/api/admin/pallets/[id]/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:g,serverHooks:w}=c;function x(){return(0,a.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:g})}},96487:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,3008,4999,4386,580],()=>r(89618));module.exports=s})();