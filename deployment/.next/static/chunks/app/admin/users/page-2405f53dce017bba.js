(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{14180:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>S});var r=a(95155),l=a(12115),t=a(97168),d=a(88482),c=a(88145),n=a(89852),i=a(82714),o=a(95784),m=a(90088),h=a(53999);let x=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,h.cn)("w-full caption-bottom text-sm",a),...l})})});x.displayName="Table";let u=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("thead",{ref:s,className:(0,h.cn)("[&_tr]:border-b",a),...l})});u.displayName="TableHeader";let j=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("tbody",{ref:s,className:(0,h.cn)("[&_tr:last-child]:border-0",a),...l})});j.displayName="TableBody",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("tfoot",{ref:s,className:(0,h.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...l})}).displayName="TableFooter";let f=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("tr",{ref:s,className:(0,h.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...l})});f.displayName="TableRow";let p=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("th",{ref:s,className:(0,h.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...l})});p.displayName="TableHead";let N=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("td",{ref:s,className:(0,h.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...l})});N.displayName="TableCell",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("caption",{ref:s,className:(0,h.cn)("mt-4 text-sm text-muted-foreground",a),...l})}).displayName="TableCaption";var g=a(99840),y=a(16559),v=a(75525),b=a(12318),w=a(40646),C=a(14186),A=a(47924),E=a(13717),R=a(62525),k=a(69803),_=a(56671);function S(){let[e,s]=(0,l.useState)([]),[a,h]=(0,l.useState)(!0),[S,F]=(0,l.useState)(""),[U,T]=(0,l.useState)("all"),[D,J]=(0,l.useState)(null),[L,Z]=(0,l.useState)(!1),[O,z]=(0,l.useState)({role:"",hasAccess:!1});(0,l.useEffect)(()=>{$()},[]);let $=async()=>{try{let e=await fetch("/api/admin/users");if(!e.ok)throw Error("Failed to fetch users");let a=await e.json();s(a),h(!1)}catch(e){console.error("Error fetching users:",e),_.o.error("Failed to fetch users"),h(!1)}},H=async(e,s)=>{try{let a={role:s.role};if(s.hasAccess?a.access_granted_at=new Date().toISOString():a.access_granted_at=null,!(await fetch("/api/admin/users",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,updates:a})})).ok)throw Error("Failed to update user");_.o.success("User updated successfully"),Z(!1),$()}catch(e){console.error("Error updating user:",e),_.o.error("Failed to update user")}},V=async e=>{try{if(!(await fetch("/api/admin/users",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})})).ok)throw Error("Failed to delete user");_.o.success("User deleted successfully"),$()}catch(e){console.error("Error deleting user:",e),_.o.error("Failed to delete user")}},B=e=>{J(e),z({role:e.role,hasAccess:!!e.access_granted_at}),Z(!0)},P=e=>{switch(e){case"admin":return(0,r.jsxs)(c.E,{variant:"default",className:"bg-red-600",children:[(0,r.jsx)(v.A,{className:"w-3 h-3 mr-1"}),"Admin"]});case"user":return(0,r.jsxs)(c.E,{variant:"secondary",children:[(0,r.jsx)(b.A,{className:"w-3 h-3 mr-1"}),"User"]});default:return(0,r.jsx)(c.E,{variant:"outline",children:e})}},q=e=>e?(0,r.jsxs)(c.E,{variant:"default",className:"bg-green-600",children:[(0,r.jsx)(w.A,{className:"w-3 h-3 mr-1"}),"Access Granted"]}):(0,r.jsxs)(c.E,{variant:"secondary",children:[(0,r.jsx)(C.A,{className:"w-3 h-3 mr-1"}),"No Access"]}),G=e.filter(e=>{let s=e.email.toLowerCase().includes(S.toLowerCase()),a="all"===U||e.role===U;return s&&a});return a?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Users Management"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage platform users and their access permissions"})]}),(0,r.jsxs)(d.Zp,{children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{children:"Filters"})}),(0,r.jsx)(d.Wu,{children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(i.J,{htmlFor:"search",children:"Search"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(A.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)(n.p,{id:"search",placeholder:"Search by email or name...",value:S,onChange:e=>F(e.target.value),className:"pl-10"})]})]}),(0,r.jsxs)("div",{className:"w-48",children:[(0,r.jsx)(i.J,{htmlFor:"role",children:"Role"}),(0,r.jsxs)(o.l6,{value:U,onValueChange:T,children:[(0,r.jsx)(o.bq,{children:(0,r.jsx)(o.yv,{})}),(0,r.jsxs)(o.gC,{children:[(0,r.jsx)(o.eb,{value:"all",children:"All Roles"}),(0,r.jsx)(o.eb,{value:"admin",children:"Admin"}),(0,r.jsx)(o.eb,{value:"user",children:"User"})]})]})]})]})})]}),(0,r.jsxs)(d.Zp,{children:[(0,r.jsx)(d.aR,{children:(0,r.jsxs)(d.ZB,{children:["Users (",G.length,")"]})}),(0,r.jsxs)(d.Wu,{children:[(0,r.jsxs)(x,{children:[(0,r.jsx)(u,{children:(0,r.jsxs)(f,{children:[(0,r.jsx)(p,{children:"User"}),(0,r.jsx)(p,{children:"Role"}),(0,r.jsx)(p,{children:"Access"}),(0,r.jsx)(p,{children:"Joined"}),(0,r.jsx)(p,{children:"Actions"})]})}),(0,r.jsx)(j,{children:G.map(e=>(0,r.jsxs)(f,{children:[(0,r.jsx)(N,{children:(0,r.jsx)("div",{className:"font-medium",children:e.email})}),(0,r.jsx)(N,{children:P(e.role)}),(0,r.jsx)(N,{children:q(e.access_granted_at)}),(0,r.jsx)(N,{children:(0,r.jsx)("div",{className:"text-sm",children:new Date(e.created_at).toLocaleDateString()})}),(0,r.jsx)(N,{children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(t.$,{size:"sm",variant:"outline",onClick:()=>B(e),children:[(0,r.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Edit"]}),(0,r.jsxs)(y.Lt,{children:[(0,r.jsx)(y.tv,{asChild:!0,children:(0,r.jsxs)(t.$,{size:"sm",variant:"destructive",children:[(0,r.jsx)(R.A,{className:"w-4 h-4 mr-1"}),"Delete"]})}),(0,r.jsxs)(y.EO,{children:[(0,r.jsxs)(y.wd,{children:[(0,r.jsx)(y.r7,{children:"Delete User"}),(0,r.jsxs)(y.$v,{children:["Are you sure you want to delete ",e.email,"? This action cannot be undone."]})]}),(0,r.jsxs)(y.ck,{children:[(0,r.jsx)(y.Zr,{children:"Cancel"}),(0,r.jsx)(y.Rx,{onClick:()=>V(e.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})})]},e.id))})]}),0===G.length&&(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No users found matching your criteria."})]})]}),(0,r.jsx)(g.lG,{open:L,onOpenChange:Z,children:(0,r.jsxs)(g.Cf,{children:[(0,r.jsx)(g.c7,{children:(0,r.jsx)(g.L3,{children:"Edit User"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i.J,{htmlFor:"email",children:"Email"}),(0,r.jsx)(n.p,{id:"email",value:(null==D?void 0:D.email)||"",disabled:!0,className:"bg-gray-50"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(i.J,{htmlFor:"role",children:"Role"}),(0,r.jsxs)(o.l6,{value:O.role,onValueChange:e=>z({...O,role:e}),children:[(0,r.jsx)(o.bq,{children:(0,r.jsx)(o.yv,{})}),(0,r.jsxs)(o.gC,{children:[(0,r.jsx)(o.eb,{value:"user",children:"User"}),(0,r.jsx)(o.eb,{value:"admin",children:"Admin"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)(i.J,{htmlFor:"access",className:"text-base font-medium flex items-center",children:[(0,r.jsx)(k.A,{className:"w-4 h-4 mr-2"}),"Platform Access"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:O.hasAccess?"User has access to the platform":"User needs invitation code to access platform"})]}),(0,r.jsx)(m.d,{id:"access",checked:O.hasAccess,onCheckedChange:e=>z({...O,hasAccess:e})})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsx)(t.$,{variant:"outline",onClick:()=>Z(!1),className:"flex-1",children:"Cancel"}),(0,r.jsx)(t.$,{onClick:()=>{D&&H(D.id,O)},className:"flex-1",children:"Save Changes"})]})]})]})})]})}},16559:(e,s,a)=>{"use strict";a.d(s,{$v:()=>f,EO:()=>h,Lt:()=>n,Rx:()=>p,Zr:()=>N,ck:()=>u,r7:()=>j,tv:()=>i,wd:()=>x});var r=a(95155),l=a(12115),t=a(62278),d=a(53999),c=a(97168);let n=t.bL,i=t.l9,o=t.ZL,m=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.hJ,{className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:s})});m.displayName=t.hJ.displayName;let h=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsxs)(o,{children:[(0,r.jsx)(m,{}),(0,r.jsx)(t.UC,{ref:s,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});h.displayName=t.UC.displayName;let x=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...a})};x.displayName="AlertDialogHeader";let u=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};u.displayName="AlertDialogFooter";let j=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.hE,{ref:s,className:(0,d.cn)("text-lg font-semibold",a),...l})});j.displayName=t.hE.displayName;let f=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.VY,{ref:s,className:(0,d.cn)("text-sm text-muted-foreground",a),...l})});f.displayName=t.VY.displayName;let p=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.rc,{ref:s,className:(0,d.cn)((0,c.r)(),a),...l})});p.displayName=t.rc.displayName;let N=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.ZD,{ref:s,className:(0,d.cn)((0,c.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});N.displayName=t.ZD.displayName},45275:(e,s,a)=>{Promise.resolve().then(a.bind(a,14180))}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,6421,6272,9440,6671,7898,3906,8441,1684,7358],()=>s(45275)),_N_E=e.O()}]);