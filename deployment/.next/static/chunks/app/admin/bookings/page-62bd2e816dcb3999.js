(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6907],{8538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(95155),a=r(12115),i=r(88482),n=r(88145),l=r(97168),d=r(95139),o=r(62525),c=r(91788),u=r(5623),m=r(69074),x=r(37873),f=r(55868),v=r(47924),h=r(1482),g=r(92657),b=r(13717);function p(){let[e,t]=(0,a.useState)([]),[r,p]=(0,a.useState)([]),[y,j]=(0,a.useState)([]),[N,w]=(0,a.useState)(!0),[k,_]=(0,a.useState)([]),[C,E]=(0,a.useState)("");(0,a.useEffect)(()=>{A()},[]);let A=async()=>{try{var e;let r=await fetch("/api/admin/bookings"),s=await r.json();t(s.bookings||[]),p(s.reservations||[]);let a=(null===(e=s.bookings)||void 0===e?void 0:e.map(e=>{var t;let r=null===(t=s.reservations)||void 0===t?void 0:t.find(t=>t.user_id===e.user_id&&864e5>Math.abs(new Date(t.created_at).getTime()-new Date(e.created_at).getTime()));return{...e,reservation:r||{id:e.user_id,status:e.status||"reserved",created_at:e.created_at,user_id:e.user_id,profiles:{email:"user-".concat(e.user_id.substring(0,8)),role:"customer"}}}}))||[];j(a)}catch(e){console.error("Failed to fetch bookings:",e)}finally{w(!1)}},S=(null==e?void 0:e.length)||0,z=(null==e?void 0:e.reduce((e,t)=>e+t.quantity,0))||0,D=(null==e?void 0:e.reduce((e,t)=>{var r;return e+t.quantity*((null===(r=t.wines)||void 0===r?void 0:r.base_price_cents)||0)},0))||0,B=e=>new Intl.NumberFormat("sv-SE",{style:"currency",currency:"SEK"}).format(e/100),T=(e,t)=>{t?_(t=>[...t,e]):_(t=>t.filter(t=>t!==e))},L=async()=>{if(0!==k.length&&confirm("Are you sure you want to delete ".concat(k.length," booking(s)? This action cannot be undone.")))try{(await fetch("/api/admin/bookings",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookingIds:k})})).ok?(_([]),A()):alert("Failed to delete bookings")}catch(e){console.error("Error deleting bookings:",e),alert("Failed to delete bookings")}},R=y.filter(e=>{var t,r,s,a,i,n,l,d,o,c;if(!C)return!0;let u=C.toLowerCase();return(null===(r=e.wines)||void 0===r?void 0:null===(t=r.wine_name)||void 0===t?void 0:t.toLowerCase().includes(u))||(null===(i=e.wines)||void 0===i?void 0:null===(a=i.producers)||void 0===a?void 0:null===(s=a.name)||void 0===s?void 0:s.toLowerCase().includes(u))||(null===(d=e.reservation)||void 0===d?void 0:null===(l=d.profiles)||void 0===l?void 0:null===(n=l.email)||void 0===n?void 0:n.toLowerCase().includes(u))||(null===(c=e.reservation)||void 0===c?void 0:null===(o=c.id)||void 0===o?void 0:o.toLowerCase().includes(u))});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Bookings"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage customer wine reservations"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[k.length>0&&(0,s.jsxs)(l.$,{variant:"destructive",size:"sm",onClick:L,children:[(0,s.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Delete (",k.length,")"]}),(0,s.jsxs)(l.$,{variant:"outline",size:"sm",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsx)(l.$,{variant:"outline",size:"sm",children:(0,s.jsx)(u.A,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)(i.Zp,{children:(0,s.jsx)(i.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Bookings"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:S}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Individual reservations"})]}),(0,s.jsx)(m.A,{className:"h-10 w-10 text-blue-600"})]})})}),(0,s.jsx)(i.Zp,{children:(0,s.jsx)(i.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Bottles"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:z}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Bottles reserved"})]}),(0,s.jsx)(x.A,{className:"h-10 w-10 text-purple-600"})]})})}),(0,s.jsx)(i.Zp,{children:(0,s.jsx)(i.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Value"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:B(D)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Estimated value"})]}),(0,s.jsx)(f.A,{className:"h-10 w-10 text-green-600"})]})})})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"All Bookings"}),(0,s.jsx)(i.BT,{children:"Complete list of all wine reservations"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search bookings...",value:C,onChange:e=>E(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)(l.$,{variant:"outline",size:"sm",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Filter"]})]})]})}),(0,s.jsx)(i.Wu,{children:N?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading bookings..."})]}):R&&R.length>0?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:(0,s.jsx)(d.S,{checked:k.length===R.length&&R.length>0,onCheckedChange:e=>{e?_(y.map(e=>e.id)):_([])}})}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Order ID"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Customer"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Status"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Wine"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Producer"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Pallet"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Quantity"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Price Band"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Value"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Date"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:R.map(e=>{var t,r,a,i,o,c,u,m,x,f,v,h,p,y,j,N;return(0,s.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)(d.S,{checked:k.includes(e.id),onCheckedChange:t=>T(e.id,t)})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)("div",{className:"font-mono text-sm text-gray-600",children:(null===(r=e.reservation)||void 0===r?void 0:null===(t=r.id)||void 0===t?void 0:t.substring(0,8))||"N/A"})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:(null===(i=e.reservation)||void 0===i?void 0:null===(a=i.profiles)||void 0===a?void 0:a.email)||"Unknown"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:(null===(c=e.reservation)||void 0===c?void 0:null===(o=c.profiles)||void 0===o?void 0:o.role)||"Customer"})]})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)(n.E,{variant:"secondary",className:(null===(u=e.reservation)||void 0===u?void 0:u.status)==="placed"?"bg-blue-100 text-blue-800":(null===(m=e.reservation)||void 0===m?void 0:m.status)==="confirmed"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:(null===(x=e.reservation)||void 0===x?void 0:x.status)||e.status||"Unknown"})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium text-gray-900",children:[null===(f=e.wines)||void 0===f?void 0:f.wine_name," ",null===(v=e.wines)||void 0===v?void 0:v.vintage]}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:null===(h=e.wines)||void 0===h?void 0:h.grape_varieties})]})}),(0,s.jsx)("td",{className:"p-3 text-gray-900",children:null===(y=e.wines)||void 0===y?void 0:null===(p=y.producers)||void 0===p?void 0:p.name}),(0,s.jsx)("td",{className:"p-3 text-gray-900",children:(null===(j=e.pallets)||void 0===j?void 0:j.name)||"No Pallet Assigned"}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)(n.E,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[e.quantity," bottles"]})}),(0,s.jsx)("td",{className:"p-3 text-gray-900",children:e.band}),(0,s.jsx)("td",{className:"p-3 font-medium text-gray-900",children:B(((null===(N=e.wines)||void 0===N?void 0:N.base_price_cents)||0)*e.quantity)}),(0,s.jsx)("td",{className:"p-3 text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.$,{variant:"outline",size:"sm",className:"text-xs",children:[(0,s.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"View"]}),(0,s.jsxs)(l.$,{size:"sm",className:"text-xs",children:[(0,s.jsx)(b.A,{className:"h-3 w-3 mr-1"}),"Edit"]})]})})]},e.id)})})]})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(m.A,{className:"h-16 w-16 mx-auto mb-4 text-gray-400"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2 text-gray-900",children:"No bookings found"}),(0,s.jsx)("p",{className:"text-gray-500",children:"When customers make reservations, they will appear here."})]})})]})]})}},50883:(e,t,r)=>{"use strict";r.d(t,{E6:()=>a,hs:()=>i,tY:()=>s});let s=[{label:"37\xb047'33.4\"N 122\xb024'18.6\"W",href:"https://maps.app.goo.gl/MnpbPDEHxoDydc9M9"},{label:"(269) 682-1402",href:"https://joyco.studio/showcase"},{label:"Instagram",href:"https://www.instagram.com/joyco.studio/"}],a="Default Title",i={red:"#ef4444",blue:"#3b82f6",green:"#22c55e",yellow:"#eab308",orange:"#f97316",purple:"#a855f7",pink:"#ec4899",black:"#000000",white:"#ffffff",gray:"#6b7280",grey:"#6b7280",brown:"#92400e",navy:"#1e3a8a",teal:"#14b8a6",cyan:"#06b6d4",indigo:"#6366f1",violet:"#8b5cf6",lime:"#84cc16",emerald:"#10b981",rose:"#f43f5e",fuchsia:"#d946ef",slate:"#64748b",neutral:"#737373",stone:"#78716c",zinc:"#71717a","light-blue":"#38bdf8","dark-blue":"#1e40af","light-green":"#4ade80","dark-green":"#232E23","light-gray":"#d1d5db","dark-gray":"#374151","light-grey":"#d1d5db","dark-grey":"#374151","dark-brown":"#6b4a1b",beige:"#f5f5dc",maroon:"#800000",olive:"#808000",aqua:"#00ffff",silver:"#c0c0c0",gold:"#ffd700",coral:"#ff7f50",salmon:"#fa8072",khaki:"#f0e68c",sand:"#e7d3b7",plum:"#dda0dd",tan:"#d2b48c",crimson:"#dc143c",turquoise:"#40e0d0",lavender:"#e6e6fa",ivory:"#fffff0",mint:"#98fb98",peach:"#ffcba4",pistachio:"#93c572",cream:"#edd0ae","army-green":"#4b5320","navy-blue":"#000080",wood:"#8d6e63"}},53999:(e,t,r)=>{"use strict";r.d(t,{cO:()=>l,cn:()=>n,jo:()=>d});var s=r(52596),a=r(39688),i=r(50883);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}function l(e,t){let r=null==t?void 0:t.toString(),s="".concat(r.length?"?":"").concat(r);return"".concat(e).concat(s)}function d(e){if(!e)return"#000000";let t=e.toLowerCase();if(i.hs[t])return i.hs[t];for(let[e,r]of Object.entries(i.hs))if(t.includes(e)||e.includes(t))return r;return"#666666"}},60937:(e,t,r)=>{Promise.resolve().then(r.bind(r,8538))},88145:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var s=r(95155);r(12115);var a=r(66634),i=r(74466),n=r(53999);let l=(0,i.F)("inline-flex uppercase font-semibold items-center justify-center rounded-md border px-2 py-0.5 text-xs w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground","outline-secondary":"text-base border border-foreground py-0.5 px-2.5 opacity-50"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,asChild:i=!1,...d}=e,o=i?a.DX:"span";return(0,s.jsx)(o,{"data-slot":"badge",className:(0,n.cn)(l({variant:r}),t),...d})}},88482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>l});var s=r(95155),a=r(12115),i=r(53999);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-md bg-card text-card-foreground",r),...a})});n.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-4",r),...a})});l.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold text-lg leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-4 pt-0",r),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},95139:(e,t,r)=>{"use strict";r.d(t,{S:()=>d});var s=r(95155),a=r(12115),i=r(9146),n=r(5196),l=r(53999);let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(i.bL,{ref:t,className:(0,l.cn)("peer bg-background h-4 w-4 shrink-0 rounded-sm border border-primary focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...a,children:(0,s.jsx)(i.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})})});d.displayName=i.bL.displayName},97168:(e,t,r)=>{"use strict";r.d(t,{$:()=>o,r:()=>d});var s=r(95155),a=r(12115),i=r(66634),n=r(74466),l=r(53999);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-semibold transition-colors-and-shadows duration-300 ease-out focus-visible:outline-none focus-visible:border-border/15 focus-visible:ring-1 focus-visible:ring-primary/70 focus-visible:ring-offset-4 focus-visible:ring-offset-foreground/20 focus-visible:shadow-button-hover disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-6 [&_svg]:shrink-0 disabled:cursor-not-allowed",{variants:{variant:{default:"border border-border/50 hover:border-border/15 bg-primary/20 focus-visible:bg-primary/30 hover:bg-primary/30 backdrop-blur-sm text-primary ring-1 ring-offset-primary/10 ring-border/10 ring-offset-2 hover:ring-primary/15 hover:ring-offset-4 hover:ring-offset-black/20 shadow-button hover:shadow-button-hover",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-background/10 backdrop-blur-lg text-foreground hover:bg-background/20",ghost:"font-medium text-foreground/50 hover:bg-accent hover:text-foreground/70 dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline",iconButton:"border border-border/50 hover:border-border/15 bg-primary disabled:bg-primary/40 hover:bg-primary backdrop-blur-sm disabled:text-primary-foreground/50 text-primary-foreground ring-1 ring-offset-transparent ring-transparent ring-offset-2 hover:ring-primary/15 hover:ring-offset-4 hover:ring-offset-black/20 shadow-button hover:shadow-button-hover"},size:{sm:"h-8 px-3 text-xs",default:"h-9 px-4 py-2",lg:"h-10 px-8",icon:"size-9","icon-lg":"size-10","icon-xl":"size-11"},shine:{true:"relative overflow-hidden after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-white/20 after:to-transparent after:animate-shine after:pointer-events-none"}},defaultVariants:{variant:"default",size:"default",shine:!1}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,asChild:o=!1,shine:c,...u}=e,m=o?i.DX:"button";return(0,s.jsx)(m,{className:(0,l.cn)(d({variant:a,size:n,className:r,shine:c})),ref:t,...u})});o.displayName="Button"}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,9146,4530,8441,1684,7358],()=>t(60937)),_N_E=e.O()}]);