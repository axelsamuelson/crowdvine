(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7986],{4655:(e,t,a)=>{"use strict";a.d(t,{WineBoxesList:()=>g});var s=a(95155),i=a(12115),n=a(88482),l=a(88145),r=a(97168),d=a(92657),o=a(13717),c=a(66766),x=a(6874),m=a.n(x),h=a(28513);function g(){let[e,t]=(0,i.useState)([]),[a,x]=(0,i.useState)(!0);(0,i.useEffect)(()=>{g()},[]);let g=async()=>{try{let e=await fetch("/api/admin/wine-boxes");if(e.ok){let a=await e.json();t(a)}else console.log("Wine boxes table not set up yet"),t([])}catch(e){console.error("Error fetching wine boxes:",e),t([])}finally{x(!1)}};return a?(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{children:"Wine Boxes"}),(0,s.jsx)(n.BT,{children:"Loading wine boxes..."})]}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))})})]}):(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{children:"All Wine Boxes"}),(0,s.jsx)(n.BT,{children:"Complete list of all wine box packages"})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Image"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Wine Box"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Margin"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Pricing"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Handle"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Status"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium text-sm text-gray-600",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)("div",{className:"relative w-16 h-16 bg-gray-100 rounded-lg overflow-hidden",children:e.image_url?(0,s.jsx)(c.default,{src:e.image_url,alt:e.name,fill:!0,className:"object-cover",sizes:"64px"}):(0,s.jsx)("div",{className:"flex items-center justify-center w-full h-full text-gray-400 text-xs",children:"No Image"})})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500 overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",maxHeight:"2.5rem"},children:e.description})]})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)(l.E,{variant:"outline",className:"text-xs",children:[e.margin_percentage,"%"]})}),(0,s.jsx)("td",{className:"p-3 text-sm text-gray-500",children:"Dynamic pricing"}),(0,s.jsx)("td",{className:"p-3 text-sm text-gray-500 font-mono",children:e.handle}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)(l.E,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.$,{variant:"outline",size:"sm",children:(0,s.jsx)(d.A,{className:"h-4 w-4"})}),(0,s.jsx)(m(),{href:"/admin/wine-boxes/".concat(e.id),children:(0,s.jsx)(r.$,{variant:"outline",size:"sm",children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})}),(0,s.jsx)(h.DeleteWineBoxButton,{wineBoxId:e.id,wineBoxName:e.name})]})})]},e.id))})]})}),0===e.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"No wine boxes found"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"Note: Make sure the wine_boxes database table is set up first."})]})]})]})}},10822:(e,t,a)=>{Promise.resolve().then(a.bind(a,45749)),Promise.resolve().then(a.bind(a,4655))},45749:(e,t,a)=>{"use strict";a.d(t,{CreateWineBoxButton:()=>h});var s=a(95155),i=a(12115),n=a(97168),l=a(84616),r=a(99840),d=a(89852),o=a(82714),c=a(99474),x=a(25676);function m(e){let{isOpen:t,onClose:a}=e,[l,m]=(0,i.useState)({name:"",description:"",handle:"",margin_percentage:"",image_url:""}),[h,g]=(0,i.useState)([]),[p,u]=(0,i.useState)(!1),j=async e=>{if(e.preventDefault(),0===h.length){alert("Please select at least one wine for the box.");return}u(!0);try{let e=await fetch("/api/admin/wine-boxes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...l,margin_percentage:parseFloat(l.margin_percentage)})});if(!e.ok)throw Error("Failed to create wine box");let t=await e.json();if(!(await fetch("/api/admin/wine-boxes/".concat(t.id,"/items"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wineItems:h})})).ok)throw Error("Failed to add wines to box");a(),m({name:"",description:"",handle:"",margin_percentage:"",image_url:""}),g([]),window.location.reload()}catch(e){console.error("Error creating wine box:",e),alert("Failed to create wine box. Please try again.")}finally{u(!1)}},f=(e,t)=>{if(m(a=>({...a,[e]:t})),"name"===e){let e=t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");m(t=>({...t,handle:e}))}};return(0,s.jsx)(r.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(r.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)(r.c7,{children:(0,s.jsx)(r.L3,{children:"Create New Wine Box"})}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"name",children:"Name"}),(0,s.jsx)(d.p,{id:"name",value:l.name,onChange:e=>f("name",e.target.value),placeholder:"e.g., Organic Discovery Box",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"handle",children:"Handle"}),(0,s.jsx)(d.p,{id:"handle",value:l.handle,onChange:e=>f("handle",e.target.value),placeholder:"e.g., organic-discovery-box",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"description",children:"Description"}),(0,s.jsx)(c.T,{id:"description",value:l.description,onChange:e=>f("description",e.target.value),placeholder:"Describe the wine box...",rows:3,required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"margin_percentage",children:"Margin Percentage"}),(0,s.jsx)(d.p,{id:"margin_percentage",type:"number",step:"0.01",min:"0",max:"100",value:l.margin_percentage,onChange:e=>f("margin_percentage",e.target.value),placeholder:"15.00",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"image_url",children:"Image URL"}),(0,s.jsx)(d.p,{id:"image_url",value:l.image_url,onChange:e=>f("image_url",e.target.value),placeholder:"https://images.unsplash.com/...",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{children:"Select Wines"}),(0,s.jsx)(x.d,{selectedWines:h,onWinesChange:g}),h.length>0&&(0,s.jsxs)("div",{className:"mt-2 text-sm text-muted-foreground",children:["Selected ",h.length," wine(s) with ",h.reduce((e,t)=>e+t.quantity,0)," total bottles"]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(n.$,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),(0,s.jsx)(n.$,{type:"submit",disabled:p||0===h.length,children:p?"Creating...":"Create Wine Box"})]})]})]})})}function h(){let[e,t]=(0,i.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.$,{onClick:()=>t(!0),children:[(0,s.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Create Wine Box"]}),(0,s.jsx)(m,{isOpen:e,onClose:()=>t(!1)})]})}},99840:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>m,L3:()=>g,c7:()=>h,lG:()=>d,zM:()=>o});var s=a(95155),i=a(12115),n=a(26272),l=a(54416),r=a(53999);let d=n.bL,o=n.l9,c=n.ZL;n.bm;let x=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)(n.hJ,{ref:t,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i})});x.displayName=n.hJ.displayName;let m=i.forwardRef((e,t)=>{let{className:a,children:i,...d}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(x,{}),(0,s.jsxs)(n.UC,{ref:t,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...d,children:[i,(0,s.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.UC.displayName;let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};h.displayName="DialogHeader";let g=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)(n.hE,{ref:t,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",a),...i})});g.displayName=n.hE.displayName,i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...i})}).displayName=n.VY.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,6421,6874,6272,3063,9146,7495,657,8441,1684,7358],()=>t(10822)),_N_E=e.O()}]);