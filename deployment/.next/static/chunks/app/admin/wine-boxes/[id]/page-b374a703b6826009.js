(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8392],{5196:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},23404:(e,t,r)=>{"use strict";r.d(t,{B:()=>u});var a=r(95155),i=r(12115),n=r(97168),s=r(88482),l=r(49026),o=r(29869),d=r(92657),c=r(54416);function u(e){let{onImagesChange:t,images:r}=e,[u,p]=(0,i.useState)(!1),[h,m]=(0,i.useState)(""),g=(0,i.useRef)(null),x=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?p(!0):"dragleave"===e.type&&p(!1)},f=e=>{t(r.filter((t,r)=>r!==e))},v=(e,a)=>{let i=[...r],[n]=i.splice(e,1);i.splice(a,0,n),t(i)};return(0,a.jsxs)(s.Zp,{children:[(0,a.jsxs)(s.aR,{children:[(0,a.jsx)(s.ZB,{children:"Product Images"}),(0,a.jsx)(s.BT,{children:"Upload multiple images for this product. Drag and drop to reorder."})]}),(0,a.jsxs)(s.Wu,{className:"space-y-4",children:[h&&(0,a.jsx)(l.Fc,{variant:"destructive",children:(0,a.jsx)(l.TN,{children:h})}),(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(u?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400"),onDragEnter:x,onDragLeave:x,onDragOver:x,onDrop:e=>{e.preventDefault(),e.stopPropagation(),p(!1),m("");let a=Array.from(e.dataTransfer.files),i=a.filter(e=>e.type.startsWith("image/"));i.length!==a.length&&m("Some files are not images and were ignored"),i.length>0&&t([...r,...i])},children:[(0,a.jsx)(o.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drop images here or click to upload"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Supports JPG, PNG, GIF up to 10MB each"}),(0,a.jsx)(n.$,{onClick:()=>{var e;null===(e=g.current)||void 0===e||e.click()},variant:"outline",type:"button",children:"Choose Files"}),(0,a.jsx)("input",{ref:g,type:"file",multiple:!0,accept:"image/*",onChange:e=>{let a=Array.from(e.target.files||[]).filter(e=>e.type.startsWith("image/"));a.length>0&&t([...r,...a])},className:"hidden"})]}),r.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Uploaded Images (",r.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-lg border overflow-hidden bg-gray-100",children:(0,a.jsx)("img",{src:URL.createObjectURL(e),alt:"Product image ".concat(t+1),className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center space-x-1",children:[(0,a.jsx)(n.$,{size:"sm",variant:"secondary",type:"button",className:"h-6 w-6 p-0",onClick:()=>{let t=window.open(URL.createObjectURL(e));t&&t.focus()},children:(0,a.jsx)(d.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{size:"sm",variant:"destructive",type:"button",className:"h-6 w-6 p-0",onClick:()=>f(t),children:(0,a.jsx)(c.A,{className:"h-3 w-3"})})]}),(0,a.jsxs)("div",{className:"absolute top-1 left-1 space-y-1",children:[t>0&&(0,a.jsx)(n.$,{size:"sm",variant:"secondary",className:"h-4 w-4 p-0 text-xs",type:"button",onClick:()=>v(t,t-1),children:"↑"}),t<r.length-1&&(0,a.jsx)(n.$,{size:"sm",variant:"secondary",className:"h-4 w-4 p-0 text-xs",type:"button",onClick:()=>v(t,t+1),children:"↓"})]}),(0,a.jsx)("div",{className:"absolute top-1 right-1 bg-black/70 text-white text-xs px-1 py-0.5 rounded text-[10px]",children:t+1})]},t))}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,a.jsx)("p",{children:"• First image will be the main product image"}),(0,a.jsx)("p",{children:"• Drag and drop or use arrow buttons to reorder"}),(0,a.jsx)("p",{children:"• Click the eye icon to preview full size"})]})]})]})]})}},29869:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},32297:(e,t,r)=>{Promise.resolve().then(r.bind(r,87481)),Promise.resolve().then(r.bind(r,28513))},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},45503:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(12115);function i(e){let t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},47602:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var a=r(12115),i=globalThis?.document?a.useLayoutEffect:()=>{};function n(e){let[t,r]=a.useState(void 0);return i(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let a,i;if(!Array.isArray(t)||!t.length)return;let n=t[0];if("borderBoxSize"in n){let e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,i=t.blockSize}else a=e.offsetWidth,i=e.offsetHeight;r({width:a,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}},49026:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>o,TN:()=>c,XL:()=>d,ju:()=>l});var a=r(95155),i=r(12115),n=r(74466),s=r(53999);let l=(0,n.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-3 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-card text-foreground",destructive:"border-destructive/50 bg-card text-destructive dark:border-destructive [&>svg]:text-destructive",success:"border-green-500/50 bg-green-50 text-green-700 dark:border-green-500 dark:bg-green-950 dark:text-green-300 [&>svg]:text-green-600 dark:[&>svg]:text-green-400"}},defaultVariants:{variant:"default"}}),o=i.forwardRef((e,t)=>{let{className:r,variant:i,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,s.cn)(l({variant:i}),r),...n})});o.displayName="Alert";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("h5",{ref:t,className:(0,s.cn)("mb-1 font-medium leading-none tracking-tight",r),...i})});d.displayName="AlertTitle";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-sm [&_p]:leading-relaxed",r),...i})});c.displayName="AlertDescription"},54416:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},62278:(e,t,r)=>{"use strict";r.d(t,{rc:()=>W,ZD:()=>L,UC:()=>B,VY:()=>z,hJ:()=>T,ZL:()=>O,bL:()=>E,hE:()=>J,l9:()=>F});var a=r(12115),i=r(46081),n=r(6101),s=r(26272),l=r(85185),o=r(95155);a.forwardRef((e,t)=>{let{children:r,...i}=e,n=a.Children.toArray(r),s=n.find(u);if(s){let e=s.props.children,r=n.map(t=>t!==s?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,o.jsx)(d,{...i,ref:t,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,o.jsx)(d,{...i,ref:t,children:r})}).displayName="Slot";var d=a.forwardRef((e,t)=>{let{children:r,...i}=e;if(a.isValidElement(r)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(r=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(r);return a.cloneElement(r,{...function(e,t){let r={...t};for(let a in t){let i=e[a],n=t[a];/^on[A-Z]/.test(a)?i&&n?r[a]=(...e)=>{n(...e),i(...e)}:i&&(r[a]=i):"style"===a?r[a]={...i,...n}:"className"===a&&(r[a]=[i,n].filter(Boolean).join(" "))}return{...e,...r}}(i,r.props),ref:t?(0,n.t)(t,e):e})}return a.Children.count(r)>1?a.Children.only(null):null});d.displayName="SlotClone";var c=({children:e})=>(0,o.jsx)(o.Fragment,{children:e});function u(e){return a.isValidElement(e)&&e.type===c}var p="AlertDialog",[h,m]=(0,i.A)(p,[s.Hs]),g=(0,s.Hs)(),x=e=>{let{__scopeAlertDialog:t,...r}=e,a=g(t);return(0,o.jsx)(s.bL,{...a,...r,modal:!0})};x.displayName=p;var f=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=g(r);return(0,o.jsx)(s.l9,{...i,...a,ref:t})});f.displayName="AlertDialogTrigger";var v=e=>{let{__scopeAlertDialog:t,...r}=e,a=g(t);return(0,o.jsx)(s.ZL,{...a,...r})};v.displayName="AlertDialogPortal";var y=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=g(r);return(0,o.jsx)(s.hJ,{...i,...a,ref:t})});y.displayName="AlertDialogOverlay";var b="AlertDialogContent",[j,w]=h(b),N=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:i,...d}=e,u=g(r),p=a.useRef(null),h=(0,n.s)(t,p),m=a.useRef(null);return(0,o.jsx)(s.G$,{contentName:b,titleName:k,docsSlug:"alert-dialog",children:(0,o.jsx)(j,{scope:r,cancelRef:m,children:(0,o.jsxs)(s.UC,{role:"alertdialog",...u,...d,ref:h,onOpenAutoFocus:(0,l.m)(d.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=m.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,o.jsx)(c,{children:i}),(0,o.jsx)(_,{contentRef:p})]})})})});N.displayName=b;var k="AlertDialogTitle",A=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=g(r);return(0,o.jsx)(s.hE,{...i,...a,ref:t})});A.displayName=k;var C="AlertDialogDescription",S=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=g(r);return(0,o.jsx)(s.VY,{...i,...a,ref:t})});S.displayName=C;var D=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=g(r);return(0,o.jsx)(s.bm,{...i,...a,ref:t})});D.displayName="AlertDialogAction";var R="AlertDialogCancel",P=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,{cancelRef:i}=w(R,r),l=g(r),d=(0,n.s)(t,i);return(0,o.jsx)(s.bm,{...l,...a,ref:d})});P.displayName=R;var _=e=>{let{contentRef:t}=e,r="`".concat(b,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(b,"` by passing a `").concat(C,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(b,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return a.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},E=x,F=f,O=v,T=y,B=N,W=D,L=P,J=A,z=S},62525:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},72797:(e,t,r)=>{"use strict";r.d(t,{b:()=>o});var a=r(12115);r(47650);var i=r(66634),n=r(95155),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,i.TL)(`Primitive.${t}`),s=a.forwardRef((e,a)=>{let{asChild:i,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(i?r:t,{...s,ref:a})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),l=a.forwardRef((e,t)=>(0,n.jsx)(s.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var o=l},87481:(e,t,r)=>{"use strict";r.d(t,{default:()=>m});var a=r(95155),i=r(12115),n=r(35695),s=r(97168),l=r(89852),o=r(82714),d=r(99474),c=r(88482),u=r(49026),p=r(25676),h=r(23404);function m(e){var t,r;let{wineBox:m,wineBoxItems:g=[]}=e,[x,f]=(0,i.useState)({name:(null==m?void 0:m.name)||"",description:(null==m?void 0:m.description)||"",handle:(null==m?void 0:m.handle)||"",margin_percentage:(null==m?void 0:null===(t=m.margin_percentage)||void 0===t?void 0:t.toString())||"",image_url:(null==m?void 0:m.image_url)||"",is_active:null===(r=null==m?void 0:m.is_active)||void 0===r||r}),[v,y]=(0,i.useState)([]),[b,j]=(0,i.useState)([]),[w,N]=(0,i.useState)(!1),[k,A]=(0,i.useState)(null),C=(0,n.useRouter)();(0,i.useEffect)(()=>{g&&g.length>0&&y(g.map(e=>({wineId:e.wine_id,quantity:e.quantity})))},[g]);let S=(e,t)=>{if(f(r=>({...r,[e]:t})),"name"===e){let e=t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");f(t=>({...t,handle:e}))}},D=async e=>{if(e.preventDefault(),0===v.length){A("Please select at least one wine for the box.");return}N(!0),A(null);try{let e="";if(b.length>0){let t=new FormData;b.forEach(e=>{t.append("files",e)});let r=await fetch("/api/upload",{method:"POST",body:t});if(!r.ok)throw Error("Failed to upload images");e=(await r.json()).files[0]||""}let t={...x,margin_percentage:parseFloat(x.margin_percentage),image_url:e||x.image_url};if(m){if(!(await fetch("/api/admin/wine-boxes/".concat(m.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to update wine box");if(!(await fetch("/api/admin/wine-boxes/".concat(m.id,"/items"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({wineItems:v})})).ok)throw Error("Failed to update wine items")}else{let e=await fetch("/api/admin/wine-boxes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw Error("Failed to create wine box");let r=await e.json();if(!(await fetch("/api/admin/wine-boxes/".concat(r.id,"/items"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wineItems:v})})).ok)throw Error("Failed to add wine items")}C.push("/admin/wine-boxes"),C.refresh()}catch(e){console.error("Error saving wine box:",e),A("Failed to save wine box. Please try again.")}finally{N(!1)}};return(0,a.jsxs)("form",{onSubmit:D,className:"space-y-6",children:[k&&(0,a.jsx)(u.Fc,{variant:"destructive",children:(0,a.jsx)(u.TN,{children:k})}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Wine Box Information"}),(0,a.jsx)(c.BT,{children:"Basic information about the wine box"})]}),(0,a.jsxs)(c.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"name",children:"Name *"}),(0,a.jsx)(l.p,{id:"name",value:x.name,onChange:e=>S("name",e.target.value),required:!0,placeholder:"e.g., Organic Discovery Box"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"handle",children:"Handle *"}),(0,a.jsx)(l.p,{id:"handle",value:x.handle,onChange:e=>S("handle",e.target.value),required:!0,placeholder:"e.g., organic-discovery-box"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(d.T,{id:"description",value:x.description,onChange:e=>S("description",e.target.value),placeholder:"Describe the wine box...",rows:3})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"margin_percentage",children:"Margin Percentage (%)"}),(0,a.jsx)(l.p,{id:"margin_percentage",type:"number",step:"0.01",min:"0",max:"100",value:x.margin_percentage,onChange:e=>S("margin_percentage",e.target.value),placeholder:"15.00"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{children:"Wine Box Image"}),(0,a.jsx)(h.B,{images:b,onImagesChange:j})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"is_active",checked:x.is_active,onChange:e=>S("is_active",e.target.checked),className:"rounded"}),(0,a.jsx)(o.J,{htmlFor:"is_active",children:"Active"})]})]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Wine Selection"}),(0,a.jsx)(c.BT,{children:"Select wines to include in this box"})]}),(0,a.jsxs)(c.Wu,{children:[(0,a.jsx)(p.d,{selectedWines:v,onWinesChange:y}),v.length>0&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Selected ",v.length," wine(s) with ",v.reduce((e,t)=>e+t.quantity,0)," total bottles"]})})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(s.$,{type:"button",variant:"outline",onClick:()=>C.back(),children:"Cancel"}),(0,a.jsx)(s.$,{type:"submit",disabled:w||0===v.length,children:w?"Saving...":m?"Update Wine Box":"Create Wine Box"})]})]})}},92657:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,6421,6272,9146,657,8441,1684,7358],()=>t(32297)),_N_E=e.O()}]);